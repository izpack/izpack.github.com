<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [izpack-devel] Production IzPack Mods
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:izpack-devel%40lists.berlios.de?Subject=%5Bizpack-devel%5D%20Production%20IzPack%20Mods&In-Reply-To=226e0f530801221838i74a001c2u896e3669568d8d51%40mail.gmail.com">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001449.html">
   <LINK REL="Next"  HREF="001451.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[izpack-devel] Production IzPack Mods</H1>
    <B>Jeff Gordon</B> 
    <A HREF="mailto:izpack-devel%40lists.berlios.de?Subject=%5Bizpack-devel%5D%20Production%20IzPack%20Mods&In-Reply-To=226e0f530801221838i74a001c2u896e3669568d8d51%40mail.gmail.com"
       TITLE="[izpack-devel] Production IzPack Mods">jeff.not24 at gmail.com
       </A><BR>
    <I>Thu Jan 24 20:45:26 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001449.html">[izpack-devel] Production IzPack Mods
</A></li>
        <LI>Next message: <A HREF="001451.html">[izpack-devel] Trunk Merge Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1455">[ date ]</a>
              <a href="thread.html#1455">[ thread ]</a>
              <a href="subject.html#1455">[ subject ]</a>
              <a href="author.html#1455">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Done.  The attached samples in the previous message should influence the
documentation, but I'm not setup to build or contribute to it yet.  Just
want to make sure if someone has the time to throw them in the correct spot.

- Jeff Gordon

On Jan 22, 2008 6:38 PM, Jeff Gordon &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/izpack-devel">jeff.not24 at gmail.com</A>&gt; wrote:

&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I've been working with the IzPack trunk for some time now and through our
</I>&gt;<i> release cycle have included a number of patches based on feedback I have
</I>&gt;<i> received from our company's developers, technical writers, and testers.
</I>&gt;<i> This patch is basically the rest of the changes that can only be done in a
</I>&gt;<i> single patch because of dependencies.  I know there are a lot of changes and
</I>&gt;<i> additions, but I'd like to reassure everyone that these are all being used
</I>&gt;<i> in production code going to global customers (I'm working on releasing some
</I>&gt;<i> examples).
</I>&gt;<i>
</I>&gt;<i> I've added the patch as an attachment and inline for easy reading.
</I>&gt;<i>
</I>&gt;<i> - Jeff Gordon
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Some of the highlights for this patch are:
</I>&gt;<i> - Adding multiple validator support to the password field
</I>&gt;<i> - Adding password equality validator as out-of-the-box functionality
</I>&gt;<i> - Adding a keystore validator as out-of-the-box functionality
</I>&gt;<i> - Adding a standard path selection panel for the user's use
</I>&gt;<i> - Many spelling, capitalization, and terminology corrections
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> eng.xml
</I>&gt;<i> -------
</I>&gt;<i> Changed textual descriptions to more business-like terminology
</I>&gt;<i> Corrected spelling and capitalization errors
</I>&gt;<i> Added UserPathPanel headline, messages, and captions
</I>&gt;<i> Added UserInputPanel.dir.* messages and captions
</I>&gt;<i> Added UserInputPanel.file.* messages and captions
</I>&gt;<i> (Need to test with alternative lang packs)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> build.xml
</I>&gt;<i> ---------
</I>&gt;<i> Added nimbus.jar and substance.jar for LAF
</I>&gt;<i> Added ValidatorContainer (see below)
</I>&gt;<i> Added section for UserPathPanel (see below)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> CompilerConfig.java
</I>&gt;<i> -------------------
</I>&gt;<i> Changed uninstaller name to allow file without jar extension
</I>&gt;<i> (used to control uninstall and keep windows users from double-clicking it)
</I>&gt;<i> (I left 4 character size restriction, but it's not that useful)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> PasswordGroup.java
</I>&gt;<i> ------------------
</I>&gt;<i> Added usage of ValidatorContainer
</I>&gt;<i> [This may affect Piotr's use of his newly committed validator code]
</I>&gt;<i> [I've been trying to get this all in, but he got some similar code ahead
</I>&gt;<i> of me]
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> PathSelectionPanel.java
</I>&gt;<i> -----------------------
</I>&gt;<i> Grammatical corrections in comments
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ProcessingClient.java
</I>&gt;<i> ---------------------
</I>&gt;<i> Comment about newly added fields to this interface
</I>&gt;<i> (affects PasswordGroup.java)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> UserInputPanel.java
</I>&gt;<i> -------------------
</I>&gt;<i> Added auto-install info for selected directory
</I>&gt;<i> Added error messages for no directory and not a directory
</I>&gt;<i> Added showMessage() method to encapsulate message dialog
</I>&gt;<i> Added auto-install info for selected file
</I>&gt;<i> Added error messages for no file and not a file
</I>&gt;<i> Added JavaDoc comments for specifying PasswordEqualityValidator and
</I>&gt;<i> PasswordKeystoreValidator
</I>&gt;<i> Added use of multiple validators for password field
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------------
</I>&gt;<i> - UserPathInputPanel.java
</I>&gt;<i> - UserPathPanel.java
</I>&gt;<i> - UserPathPanelAutomationHelper.java
</I>&gt;<i> - UserPathSelectionPanel.java
</I>&gt;<i> ------------------------------------
</I>&gt;<i> Implemented copy of PathPanel as UserPathPanel (as alternative to dir type
</I>&gt;<i> in UserInputPanel)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ValidatorContainer.java
</I>&gt;<i> -----------------------
</I>&gt;<i> Object representation of a validator containing the validator, error
</I>&gt;<i> message, and parameter Map
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> PasswordEqualityValidator.java
</I>&gt;<i> ------------------------------
</I>&gt;<i> Implementation of sample validator for use in any installer
</I>&gt;<i> Shows how to get at validator parameters as well
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> PasswordKeystoreValidator.java
</I>&gt;<i> ------------------------------
</I>&gt;<i> Validates keystore access using password field
</I>&gt;<i> Validates alias (key) access with password field
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------------------------------------------------------------------------------------------------
</I>&gt;<i> Patch attached, provided inline for readability
</I>&gt;<i>
</I>&gt;<i> ------------------------------------------------------------------------------------------------------------------------
</I>&gt;<i> Index: bin/langpacks/installer/eng.xml
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- bin/langpacks/installer/eng.xml    (revision 1998)
</I>&gt;<i> +++ bin/langpacks/installer/eng.xml    (working copy)
</I>&gt;<i> @@ -11,10 +11,10 @@
</I>&gt;<i>      &lt;str id=&quot;ExtendedInstallPanel.headline&quot; txt=&quot;Installation and
</I>&gt;<i> Configuration&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;FinishPanel.headline&quot; txt=&quot;Installation Finished&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;HelloPanel.headline&quot; txt=&quot;Welcome&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;HTMLInfoPanel.headline&quot; txt=&quot;Informations&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;HTMLInfoPanel.headline&quot; txt=&quot;Information&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;HTMLLicencePanel.headline&quot; txt=&quot;Licensing Agreements&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;ImgPacksPanel.headline&quot; txt=&quot;Select Installation Packages&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;InfoPanel.headline&quot; txt=&quot;Informations&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;InfoPanel.headline&quot; txt=&quot;Information&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;InstallPanel.headline&quot; txt=&quot;Installation&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;JDKPathPanel.headline&quot; txt=&quot;JDK Path&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;LicencePanel.headline&quot; txt=&quot;Licensing Agreements&quot;/&gt;
</I>&gt;<i> @@ -25,6 +25,7 @@
</I>&gt;<i>      &lt;str id=&quot;SummaryPanel.headline&quot; txt=&quot;Summary Configuration Data&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;TargetPanel.headline&quot; txt=&quot;Target Path&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;UserInputPanel.headline&quot; txt=&quot;User Data&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.headline&quot; txt=&quot;Select Path&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;InstallationTypePanel.headline&quot; txt=&quot;Installation Type&quot; /&gt;
</I>&gt;<i>
</I>&gt;<i>      &lt;!-- General installer strings --&gt;
</I>&gt;<i> @@ -46,7 +47,7 @@
</I>&gt;<i>      &lt;str id=&quot;installer.Message&quot; txt=&quot;Message&quot;/&gt;
</I>&gt;<i>
</I>&gt;<i>      &lt;!-- Uninstaller specific strings --&gt;
</I>&gt;<i> -    &lt;str id=&quot;uninstaller.warning&quot; txt=&quot;This will remove the installed
</I>&gt;<i> application(s)!&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;uninstaller.warning&quot; txt=&quot;This will remove the installed
</I>&gt;<i> application!&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;uninstaller.destroytarget&quot; txt=&quot; Force the deletion of &quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;uninstaller.uninstall&quot; txt=&quot;Uninstall&quot;/&gt;
</I>&gt;<i>
</I>&gt;<i> @@ -99,7 +100,7 @@
</I>&gt;<i>      &lt;str id=&quot;JDKPathPanel.nonValidPathInReg&quot; txt=&quot;The Windows registry
</I>&gt;<i> contains a non-valid path for this JDK. Should this JDK be used anyway?&quot;/&gt;
</I>&gt;<i>
</I>&gt;<i>      &lt;str id=&quot;PacksPanel.info&quot; txt=&quot;Select the packs you want to
</I>&gt;<i> install:&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;PacksPanel.tip&quot; txt=&quot;Note: greyed out packs are required.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;PacksPanel.tip&quot; txt=&quot;Note: Grayed packs are required.&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;PacksPanel.space&quot; txt=&quot;Total space Required: &quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;PacksPanel.freespace&quot; txt=&quot;Available space: &quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;PacksPanel.description&quot; txt=&quot;Description&quot;/&gt;
</I>&gt;<i> @@ -115,7 +116,7 @@
</I>&gt;<i>      &lt;str id=&quot;InstallPanel.info&quot; txt=&quot;Click 'Install!' to begin the
</I>&gt;<i> installation process&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;InstallPanel.install&quot; txt=&quot;Install!&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;InstallPanel.tip&quot; txt=&quot;Pack installation progress:&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;InstallPanel.begin&quot; txt=&quot;[Nothing]&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;InstallPanel.begin&quot; txt=&quot; &quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;InstallPanel.finished&quot; txt=&quot;[Finished]&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;InstallPanel.progress&quot; txt=&quot;Overall installation
</I>&gt;<i> progress:&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;InstallPanel.overwrite.title&quot; txt=&quot;File already exists&quot;/&gt;
</I>&gt;<i> @@ -165,19 +166,38 @@
</I>&gt;<i>      &lt;str id=&quot;ShortcutPanel.location.startMenu&quot;    txt=&quot;Start Menu&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;ShortcutPanel.location.startup&quot;      txt=&quot;Startup Group&quot;/&gt;
</I>&gt;<i>
</I>&gt;<i> -    &lt;str id=&quot;UserInputPanel.error.caption&quot;        txt=&quot;Input Problem&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.error.caption&quot;        txt=&quot;Error&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;UserInputPanel.search.autodetect&quot;    txt=&quot;Autodetect&quot;/&gt;
</I>&gt;<i>
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.dir.nodirectory.message&quot;   txt=&quot;You must
</I>&gt;<i> select a valid directory.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.dir.nodirectory.caption&quot;   txt=&quot;No Directory
</I>&gt;<i> Selected&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.dir.notdirectory.message&quot;   txt=&quot;The
</I>&gt;<i> directory you have chosen either does not exist or is not valid.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.dir.notdirectory.caption&quot;   txt=&quot;Invalid
</I>&gt;<i> Directory&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.file.nofile.message&quot;   txt=&quot;You must select a
</I>&gt;<i> valid file.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.file.nofile.caption&quot;   txt=&quot;No File
</I>&gt;<i> Selected&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.file.notfile.message&quot;   txt=&quot;The file you
</I>&gt;<i> have chosen either does not exist or is not valid.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.file.notfile.caption&quot;   txt=&quot;Invalid File&quot;/&gt;
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i>      &lt;!-- more descriptive error message would be cool, like specifying
</I>&gt;<i> what file we looked for --&gt;
</I>&gt;<i> -    &lt;str id=&quot;UserInputPanel.search.autodetect.failed.message&quot;
</I>&gt;<i> txt=&quot;Autodetection failed.&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;UserInputPanel.search.autodetect.failed.caption&quot;
</I>&gt;<i> txt=&quot;Autodetection failed.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.search.autodetect.failed.message&quot;
</I>&gt;<i> txt=&quot;Auto-detection failed.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.search.autodetect.failed.caption&quot;
</I>&gt;<i> txt=&quot;Auto-Detection Failed&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;UserInputPanel.search.autodetect.tooltip&quot;
</I>&gt;<i> txt=&quot;Check for the file or directory in the paths given above.&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;UserInputPanel.search.location&quot;           txt=&quot;Enter
</I>&gt;<i> location of {0}.&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;UserInputPanel.search.location.checkedfile&quot; txt=&quot;The
</I>&gt;<i> existence of {0} is checked.&quot;/&gt;
</I>&gt;<i>      &lt;str id=&quot;UserInputPanel.search.browse&quot;           txt=&quot;Browse...&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;UserInputPanel.search.wrongselection.message&quot;   txt=&quot;The
</I>&gt;<i> file or directory you choose either does not exist or is not appropiate.&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;UserInputPanel.search.wrongselection.caption&quot;   txt=&quot;Invalid
</I>&gt;<i> selection.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.search.wrongselection.message&quot;   txt=&quot;The
</I>&gt;<i> file or directory you have chosen either does not exist or is not
</I>&gt;<i> appropriate.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserInputPanel.search.wrongselection.caption&quot;   txt=&quot;Invalid
</I>&gt;<i> Selection&quot;/&gt;
</I>&gt;<i>
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.required&quot; txt=&quot;The chosen directory should
</I>&gt;<i> exist.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.info&quot; txt=&quot;Select the path: &quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.browse&quot; txt=&quot;Browse&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.exists_warn&quot; txt=&quot;The directory already
</I>&gt;<i> exists! Are you sure you want to install here and possibly overwrite
</I>&gt;<i> existing files?&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.empty_target&quot; txt=&quot;You have not specified a
</I>&gt;<i> target location! Is this correct?&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.createdir&quot; txt=&quot;The target directory will be
</I>&gt;<i> created: &quot; /&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.nodir&quot;  txt=&quot;This file is not a directory!
</I>&gt;<i> Please choose a directory!&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.notwritable&quot; txt=&quot;This directory can not be
</I>&gt;<i> written! Please choose another directory!&quot;/&gt;
</I>&gt;<i> +
</I>&gt;<i>      &lt;str id=&quot;CompilePanel.heading&quot; txt=&quot;Compilation&quot; /&gt;
</I>&gt;<i>      &lt;str id=&quot;CompilePanel.tip&quot; txt=&quot;Job compilation progress:&quot; /&gt;
</I>&gt;<i>      &lt;str id=&quot;CompilePanel.browse&quot; txt=&quot;Browse...&quot; /&gt;
</I>&gt;<i> @@ -201,18 +221,19 @@
</I>&gt;<i>      &lt;str id=&quot;ProcessPanel.heading&quot; txt=&quot;Processing&quot; /&gt;
</I>&gt;<i>
</I>&gt;<i>      &lt;!-- Strings for the summary of panels - START --&gt;
</I>&gt;<i> -    &lt;str id=&quot;SummaryPanel.info&quot; txt=&quot;Ready to install. Important data are
</I>&gt;<i> listed below. Press &amp;quot;Next&amp;quot; to start installation, &quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;TargetPanel.summaryCaption&quot; txt=&quot;Installation path&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;JDKPathPanel.summaryCaption&quot; txt=&quot;JDK path&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;PacksPanel.summaryCaption&quot; txt=&quot;Chosen installation packs&quot;/&gt;
</I>&gt;<i> -    &lt;str id=&quot;ImgPacksPanel.summaryCaption&quot; txt=&quot;Chosen installation
</I>&gt;<i> packs&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;SummaryPanel.info&quot; txt=&quot;Installation will proceed with the
</I>&gt;<i> following settings. Press Next to continue.&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;TargetPanel.summaryCaption&quot; txt=&quot;Installation Path&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;JDKPathPanel.summaryCaption&quot; txt=&quot;JDK Path&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;PacksPanel.summaryCaption&quot; txt=&quot;Chosen Installation Packs&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;ImgPacksPanel.summaryCaption&quot; txt=&quot;Chosen Installation
</I>&gt;<i> Packs&quot;/&gt;
</I>&gt;<i> +    &lt;str id=&quot;UserPathPanel.summaryCaption&quot; txt=&quot;Selected Path&quot;/&gt;
</I>&gt;<i>      &lt;!-- Strings for the summary of panels - END --&gt;
</I>&gt;<i>
</I>&gt;<i>      &lt;!-- Strings for the Registry --&gt;
</I>&gt;<i>      &lt;str id=&quot;functionFailed.RegOpenKeyEx&quot; txt=&quot;Cannot open registry key
</I>&gt;<i> {0}\\{1}.&quot;/&gt;
</I>&gt;<i>
</I>&gt;<i>      &lt;!-- Add your own panels specific strings here if you need or use a
</I>&gt;<i> custom
</I>&gt;<i> -         langpack with the same syntax referred as resoure
</I>&gt;<i> CustomLangpack.xml_[ISO3]&quot;
</I>&gt;<i> +         langpack with the same syntax referred as resource
</I>&gt;<i> CustomLangpack.xml_[ISO3]&quot;
</I>&gt;<i>      --&gt;
</I>&gt;<i>
</I>&gt;<i>      &lt;str id=&quot;nextmedia.title&quot; txt=&quot;Next install media&quot;/&gt;
</I>&gt;<i> @@ -223,7 +244,7 @@
</I>&gt;<i>      &lt;str id=&quot;nextmedia.choosertitle&quot; txt=&quot;Choose install media&quot; /&gt;
</I>&gt;<i>      &lt;str id=&quot;nextmedia.filedesc&quot; rdid=&quot;install packs (.pak*)&quot; /&gt;
</I>&gt;<i>
</I>&gt;<i> -    &lt;!-- Strings for the loggin/reporting system (Messenger) --&gt;
</I>&gt;<i> +    &lt;!-- Strings for the logging/reporting system (Messenger) --&gt;
</I>&gt;<i>
</I>&gt;<i>      &lt;!-- This string defines the time stamp format in the installation
</I>&gt;<i> report.
</I>&gt;<i>           The format details are documented in java.text.SimpleDateFormat--&gt;
</I>&gt;<i> Index: src/build.xml
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/build.xml    (revision 1998)
</I>&gt;<i> +++ src/build.xml    (working copy)
</I>&gt;<i> @@ -361,6 +361,8 @@
</I>&gt;<i>                  &lt;include name=&quot;lib/liquidlnf.jar&quot; /&gt;
</I>&gt;<i>                  &lt;include name=&quot;lib/metouia.jar&quot; /&gt;
</I>&gt;<i>                  &lt;include name=&quot;lib/looks.jar&quot; /&gt;
</I>&gt;<i> +                &lt;include name=&quot;lib/nimbus.jar&quot; /&gt;
</I>&gt;<i> +                &lt;include name=&quot;lib/substance.jar&quot; /&gt;
</I>&gt;<i>                  &lt;include name=&quot;lib/ant.jar&quot; /&gt;
</I>&gt;<i>                  &lt;include name=&quot;lib/nimbus.jar&quot; /&gt;
</I>&gt;<i>                  &lt;include name=&quot;lib/substance.jar&quot; /&gt;
</I>&gt;<i> @@ -648,7 +650,14 @@
</I>&gt;<i>              &lt;include name=&quot;com/izforge/izpack/panels/UserInputPanel.java&quot;
</I>&gt;<i> /&gt;
</I>&gt;<i>              &lt;include
</I>&gt;<i> name=&quot;com/izforge/izpack/panels/UserInputPanelAutomationHelper.java&quot; /&gt;
</I>&gt;<i>              &lt;include name=&quot;com/izforge/izpack/panels/Validator.java&quot; /&gt;
</I>&gt;<i> +            &lt;include
</I>&gt;<i> name=&quot;com/izforge/izpack/panels/ValidatorContainer.java&quot; /&gt;
</I>&gt;<i>          &lt;/build-panel&gt;
</I>&gt;<i> +        &lt;build-panel name=&quot;UserPathPanel&quot;&gt;
</I>&gt;<i> +            &lt;include
</I>&gt;<i> name=&quot;com/izforge/izpack/panels/UserPathInputPanel.java&quot; /&gt;
</I>&gt;<i> +            &lt;include
</I>&gt;<i> name=&quot;com/izforge/izpack/panels/UserPathSelectionPanel.java&quot; /&gt;
</I>&gt;<i> +            &lt;include name=&quot;com/izforge/izpack/panels/UserPathPanel.java&quot;
</I>&gt;<i> /&gt;
</I>&gt;<i> +            &lt;include
</I>&gt;<i> name=&quot;com/izforge/izpack/panels/UserPathPanelAutomationHelper.java&quot; /&gt;
</I>&gt;<i> +        &lt;/build-panel&gt;
</I>&gt;<i>          &lt;build-panel name=&quot;ConditionalUserInputPanel&quot;&gt;
</I>&gt;<i>              &lt;include
</I>&gt;<i> name=&quot;com/izforge/izpack/panels/ConditionalUserInputPanel.java&quot; /&gt;
</I>&gt;<i>              &lt;include name=&quot;com/izforge/izpack/panels/PasswordGroup.java&quot;
</I>&gt;<i> /&gt;
</I>&gt;<i> @@ -660,6 +669,7 @@
</I>&gt;<i>              &lt;include name=&quot;com/izforge/izpack/panels/UserInputPanel.java&quot;
</I>&gt;<i> /&gt;
</I>&gt;<i>              &lt;include
</I>&gt;<i> name=&quot;com/izforge/izpack/panels/UserInputPanelAutomationHelper.java&quot; /&gt;
</I>&gt;<i>              &lt;include name=&quot;com/izforge/izpack/panels/Validator.java&quot; /&gt;
</I>&gt;<i> +            &lt;include
</I>&gt;<i> name=&quot;com/izforge/izpack/panels/ValidatorContainer.java&quot; /&gt;
</I>&gt;<i>          &lt;/build-panel&gt;
</I>&gt;<i>          &lt;build-panel name=&quot;CompilePanel&quot;&gt;
</I>&gt;<i>              &lt;include name=&quot;com/izforge/izpack/panels/CompilePanel.java&quot;
</I>&gt;<i> /&gt;
</I>&gt;<i> Index: src/lib/com/izforge/izpack/compiler/CompilerConfig.java
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/lib/com/izforge/izpack/compiler/CompilerConfig.java    (revision
</I>&gt;<i> 1998)
</I>&gt;<i> +++ src/lib/com/izforge/izpack/compiler/CompilerConfig.java    (working
</I>&gt;<i> copy)
</I>&gt;<i> @@ -1511,8 +1511,7 @@
</I>&gt;<i>              if (uninstallInfo != null)
</I>&gt;<i>              {
</I>&gt;<i>                  String uninstallerName = uninstallInfo.getAttribute
</I>&gt;<i> (&quot;name&quot;);
</I>&gt;<i> -                if (uninstallerName != null &amp;&amp; uninstallerName.endsWith
</I>&gt;<i> (&quot;.jar&quot;)
</I>&gt;<i> -                        &amp;&amp; uninstallerName.length() &gt; &quot;.jar&quot;.length())
</I>&gt;<i> +                if (uninstallerName != null &amp;&amp; uninstallerName.length() &gt;
</I>&gt;<i> &quot;.jar&quot;.length())
</I>&gt;<i>                      info.setUninstallerName(uninstallerName);
</I>&gt;<i>              }
</I>&gt;<i>          }
</I>&gt;<i> Index: src/lib/com/izforge/izpack/panels/PasswordGroup.java
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/lib/com/izforge/izpack/panels/PasswordGroup.java    (revision
</I>&gt;<i> 1998)
</I>&gt;<i> +++ src/lib/com/izforge/izpack/panels/PasswordGroup.java    (working copy)
</I>&gt;<i> @@ -18,9 +18,10 @@
</I>&gt;<i>   * See the License for the specific language governing permissions and
</I>&gt;<i>   * limitations under the License.
</I>&gt;<i>   */
</I>&gt;<i> -
</I>&gt;<i>  package com.izforge.izpack.panels;
</I>&gt;<i>
</I>&gt;<i> +import com.izforge.izpack.installer.InstallData;
</I>&gt;<i> +import java.util.List;
</I>&gt;<i>  import java.util.Map;
</I>&gt;<i>  import java.util.Vector;
</I>&gt;<i>
</I>&gt;<i> @@ -46,13 +47,19 @@
</I>&gt;<i>      //
</I>&gt;<i> ------------------------------------------------------------------------
</I>&gt;<i>      private Vector fields = new Vector();
</I>&gt;<i>
</I>&gt;<i> -    private Validator validator = null;
</I>&gt;<i> -
</I>&gt;<i> +    private List validatorContainers = null;
</I>&gt;<i> +//  private Validator validator = null;
</I>&gt;<i> +//  private boolean hasParams = false;
</I>&gt;<i> +//  private Map validatorParams = null;
</I>&gt;<i>      private Processor processor = null;
</I>&gt;<i>
</I>&gt;<i> +    private int currentValidator = 0;
</I>&gt;<i> +
</I>&gt;<i> +    private InstallData idata;
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> /*--------------------------------------------------------------------------*/
</I>&gt;<i>      /**
</I>&gt;<i> -     * Creates a passowrd group to manage one or more password fields.
</I>&gt;<i> +     * Creates a password group to manage one or more password fields.
</I>&gt;<i>       *
</I>&gt;<i>       * @param validator A string that specifies a class that provides a
</I>&gt;<i> password validation service.
</I>&gt;<i>       * The class must implement the &lt;code&gt;Validator&lt;/code&gt; interface. If
</I>&gt;<i> an attempt to instantiate
</I>&gt;<i> @@ -63,18 +70,25 @@
</I>&gt;<i>       * contents of the first field will be returned.
</I>&gt;<i>       */
</I>&gt;<i>
</I>&gt;<i> /*--------------------------------------------------------------------------*/
</I>&gt;<i> -    public PasswordGroup(String validator, String processor)
</I>&gt;<i> +    public PasswordGroup(InstallData idata, List validatorContainers,
</I>&gt;<i> String processor)
</I>&gt;<i>      {
</I>&gt;<i>          // ----------------------------------------------------
</I>&gt;<i>          // attempt to create an instance of the Validator
</I>&gt;<i>          // ----------------------------------------------------
</I>&gt;<i>          try
</I>&gt;<i>          {
</I>&gt;<i> -            this.validator = (Validator) Class.forName
</I>&gt;<i> (validator).newInstance();
</I>&gt;<i> -        }
</I>&gt;<i> -        catch (Throwable exception)
</I>&gt;<i> +            this.idata = idata;
</I>&gt;<i> +//      this.validator = (Validator) Class.forName
</I>&gt;<i> (validator).newInstance();
</I>&gt;<i> +            this.validatorContainers = validatorContainers;
</I>&gt;<i> +//      this.validatorParams = validatorParams;
</I>&gt;<i> +//      if (validatorParams != null) {
</I>&gt;<i> +//        if (validatorParams.size() &gt; 0) {
</I>&gt;<i> +//          hasParams = true;
</I>&gt;<i> +//        }
</I>&gt;<i> +//      }
</I>&gt;<i> +        } catch (Throwable exception)
</I>&gt;<i>          {
</I>&gt;<i> -            this.validator = null;
</I>&gt;<i> +            this.validatorContainers = null;
</I>&gt;<i>          }
</I>&gt;<i>
</I>&gt;<i>          // ----------------------------------------------------
</I>&gt;<i> @@ -83,13 +97,17 @@
</I>&gt;<i>          try
</I>&gt;<i>          {
</I>&gt;<i>              this.processor = (Processor) Class.forName
</I>&gt;<i> (processor).newInstance();
</I>&gt;<i> -        }
</I>&gt;<i> -        catch (Throwable exception)
</I>&gt;<i> +        } catch (Throwable exception)
</I>&gt;<i>          {
</I>&gt;<i>              this.processor = null;
</I>&gt;<i>          }
</I>&gt;<i>      }
</I>&gt;<i>
</I>&gt;<i> +    public InstallData getIdata()
</I>&gt;<i> +    {
</I>&gt;<i> +        return idata;
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> /*--------------------------------------------------------------------------*/
</I>&gt;<i>      /**
</I>&gt;<i>       * Returns the number of sub-fields.
</I>&gt;<i> @@ -115,7 +133,10 @@
</I>&gt;<i>
</I>&gt;<i> /*--------------------------------------------------------------------------*/
</I>&gt;<i>      public String getFieldContents(int index) throws
</I>&gt;<i> IndexOutOfBoundsException
</I>&gt;<i>      {
</I>&gt;<i> -        if ((index &lt; 0) || (index &gt;= fields.size())) { throw (new
</I>&gt;<i> IndexOutOfBoundsException()); }
</I>&gt;<i> +        if ((index &lt; 0) || (index &gt;= fields.size()))
</I>&gt;<i> +        {
</I>&gt;<i> +            throw (new IndexOutOfBoundsException());
</I>&gt;<i> +        }
</I>&gt;<i>
</I>&gt;<i>          String contents = new String(((JPasswordField) fields.elementAt
</I>&gt;<i> (index)).getPassword());
</I>&gt;<i>          return (contents);
</I>&gt;<i> @@ -145,18 +166,125 @@
</I>&gt;<i>       * rule exists. Otherwise &lt;code&gt;false&lt;/code&gt; is returned.
</I>&gt;<i>       */
</I>&gt;<i>
</I>&gt;<i> /*--------------------------------------------------------------------------*/
</I>&gt;<i> -    public boolean validateContents()
</I>&gt;<i> +    public boolean validateContents(int i)
</I>&gt;<i>      {
</I>&gt;<i> -        if (validator != null)
</I>&gt;<i> +        boolean returnValue = true;
</I>&gt;<i> +        try
</I>&gt;<i>          {
</I>&gt;<i> -            return (validator.validate(this));
</I>&gt;<i> +            currentValidator = i;
</I>&gt;<i> +            ValidatorContainer container = getValidatorContainer(i);
</I>&gt;<i> +            Validator validator = container.getValidator();
</I>&gt;<i> +            if (validator != null)
</I>&gt;<i> +            {
</I>&gt;<i> +                returnValue = validator.validate(this);
</I>&gt;<i> +            }
</I>&gt;<i> +        } catch (Exception e)
</I>&gt;<i> +        {
</I>&gt;<i> +            System.out.println(&quot;validateContents(&quot; + i + &quot;) failed: &quot; +
</I>&gt;<i> e);
</I>&gt;<i> +        // just return true
</I>&gt;<i>          }
</I>&gt;<i> -        else
</I>&gt;<i> +        return returnValue;
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i> +    public String getValidatorMessage(int i)
</I>&gt;<i> +    {
</I>&gt;<i> +        String returnValue = null;
</I>&gt;<i> +        try
</I>&gt;<i>          {
</I>&gt;<i> -            return (true);
</I>&gt;<i> +            ValidatorContainer container = getValidatorContainer(i);
</I>&gt;<i> +            if (container != null)
</I>&gt;<i> +            {
</I>&gt;<i> +                returnValue = container.getMessage();
</I>&gt;<i> +            }
</I>&gt;<i> +        } catch (Exception e)
</I>&gt;<i> +        {
</I>&gt;<i> +            System.out.println(&quot;getValidatorMessage(&quot; + i + &quot;) failed: &quot;
</I>&gt;<i> + e);
</I>&gt;<i> +        // just return true
</I>&gt;<i>          }
</I>&gt;<i> +        return returnValue;
</I>&gt;<i>      }
</I>&gt;<i>
</I>&gt;<i> +    public int validatorSize()
</I>&gt;<i> +    {
</I>&gt;<i> +        int size = 0;
</I>&gt;<i> +        if (validatorContainers != null)
</I>&gt;<i> +        {
</I>&gt;<i> +            size = validatorContainers.size();
</I>&gt;<i> +        }
</I>&gt;<i> +        return size;
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i> +    public ValidatorContainer getValidatorContainer()
</I>&gt;<i> +    {
</I>&gt;<i> +        return getValidatorContainer(currentValidator);
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i> +    public ValidatorContainer getValidatorContainer(int i)
</I>&gt;<i> +    {
</I>&gt;<i> +        ValidatorContainer container = null;
</I>&gt;<i> +        try
</I>&gt;<i> +        {
</I>&gt;<i> +            container = (ValidatorContainer) validatorContainers.get(i);
</I>&gt;<i> +        } catch (Exception e)
</I>&gt;<i> +        {
</I>&gt;<i> +            container = null;
</I>&gt;<i> +        }
</I>&gt;<i> +        return container;
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i> +    public boolean hasParams()
</I>&gt;<i> +    {
</I>&gt;<i> +        return hasParams(currentValidator);
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i> +    public boolean hasParams(int i)
</I>&gt;<i> +    {
</I>&gt;<i> +        boolean returnValue = false;
</I>&gt;<i> +        try
</I>&gt;<i> +        {
</I>&gt;<i> +            ValidatorContainer container = getValidatorContainer(i);
</I>&gt;<i> +            if (container != null)
</I>&gt;<i> +            {
</I>&gt;<i> +                returnValue = container.hasParams();
</I>&gt;<i> +            }
</I>&gt;<i> +        } catch (Exception e)
</I>&gt;<i> +        {
</I>&gt;<i> +            System.out.println(&quot;hasParams(&quot; + i + &quot;) failed: &quot; + e);
</I>&gt;<i> +        // just return true
</I>&gt;<i> +        }
</I>&gt;<i> +        return returnValue;
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i> +    public Map getValidatorParams()
</I>&gt;<i> +    {
</I>&gt;<i> +        return getValidatorParams(currentValidator);
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i> +    public Map getValidatorParams(int i)
</I>&gt;<i> +    {
</I>&gt;<i> +        Map returnValue = null;
</I>&gt;<i> +        try
</I>&gt;<i> +        {
</I>&gt;<i> +            ValidatorContainer container = getValidatorContainer(i);
</I>&gt;<i> +            if (container != null)
</I>&gt;<i> +            {
</I>&gt;<i> +                returnValue = container.getValidatorParams();
</I>&gt;<i> +            }
</I>&gt;<i> +        } catch (Exception e)
</I>&gt;<i> +        {
</I>&gt;<i> +            System.out.println(&quot;getValidatorParams(&quot; + i + &quot;) failed: &quot; +
</I>&gt;<i> e);
</I>&gt;<i> +        // just return true
</I>&gt;<i> +        }
</I>&gt;<i> +        return returnValue;
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i> +    // This method was added to support changes to ProcessingClient
</I>&gt;<i> interface
</I>&gt;<i> +    // it's use is non-deterministic in the newly implemented text
</I>&gt;<i> validators.
</I>&gt;<i> +    public String getText()
</I>&gt;<i> +    {
</I>&gt;<i> +        return getValidatorMessage(currentValidator);
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> /*--------------------------------------------------------------------------*/
</I>&gt;<i>      /**
</I>&gt;<i>       * Returns the password. If a processing service class was supplied
</I>&gt;<i> it will be used to process
</I>&gt;<i> @@ -171,36 +299,18 @@
</I>&gt;<i>          if (processor != null)
</I>&gt;<i>          {
</I>&gt;<i>              return (processor.process(this));
</I>&gt;<i> -        }
</I>&gt;<i> -        else
</I>&gt;<i> +        } else
</I>&gt;<i>          {
</I>&gt;<i>              String contents = &quot;&quot;;
</I>&gt;<i>
</I>&gt;<i>              if (fields.size() &gt; 0)
</I>&gt;<i>              {
</I>&gt;<i> -                contents = getText();
</I>&gt;<i> +                contents = new String(((JPasswordField) fields.elementAt
</I>&gt;<i> (0)).getPassword());
</I>&gt;<i>              }
</I>&gt;<i>
</I>&gt;<i>              return (contents);
</I>&gt;<i>          }
</I>&gt;<i>      }
</I>&gt;<i>
</I>&gt;<i> -    // javadoc inherited
</I>&gt;<i> -    public String getText()
</I>&gt;<i> -    {
</I>&gt;<i> -        return new String(((JPasswordField) fields.elementAt
</I>&gt;<i> (0)).getPassword());
</I>&gt;<i> -    }
</I>&gt;<i> -
</I>&gt;<i> -    // javadoc inherited
</I>&gt;<i> -    public Map getValidatorParams()
</I>&gt;<i> -    {
</I>&gt;<i> -        return null;
</I>&gt;<i> -    }
</I>&gt;<i> -
</I>&gt;<i> -    // javadoc inherited
</I>&gt;<i> -    public boolean hasParams()
</I>&gt;<i> -    {
</I>&gt;<i> -        return false;
</I>&gt;<i> -    }
</I>&gt;<i>  }
</I>&gt;<i>
</I>&gt;<i>  /*---------------------------------------------------------------------------*/
</I>&gt;<i> Index: src/lib/com/izforge/izpack/panels/PathSelectionPanel.java
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/lib/com/izforge/izpack/panels/PathSelectionPanel.java    (revision
</I>&gt;<i> 1998)
</I>&gt;<i> +++ src/lib/com/izforge/izpack/panels/PathSelectionPanel.java    (working
</I>&gt;<i> copy)
</I>&gt;<i> @@ -91,9 +91,9 @@
</I>&gt;<i>       */
</I>&gt;<i>      protected void createLayout()
</I>&gt;<i>      {
</I>&gt;<i> -        // We woulduse the IzPanelLayout also in this &quot;sub&quot;panel.
</I>&gt;<i> -        // In an IzPanel there are support of this layout manager at
</I>&gt;<i> -        // more than one places. In this panel not, therefore we have
</I>&gt;<i> +        // We would use the IzPanelLayout also in this &quot;sub&quot; panel.
</I>&gt;<i> +        // In an IzPanel there is support for this layout manager in
</I>&gt;<i> +        // more than one place, but not in this panel so we have
</I>&gt;<i>          // to make all things needed.
</I>&gt;<i>          // First create a layout helper.
</I>&gt;<i>          LayoutHelper layoutHelper = new LayoutHelper(this);
</I>&gt;<i> Index: src/lib/com/izforge/izpack/panels/ProcessingClient.java
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/lib/com/izforge/izpack/panels/ProcessingClient.java    (revision
</I>&gt;<i> 1998)
</I>&gt;<i> +++ src/lib/com/izforge/izpack/panels/ProcessingClient.java    (working
</I>&gt;<i> copy)
</I>&gt;<i> @@ -58,7 +58,10 @@
</I>&gt;<i>       */
</I>&gt;<i>
</I>&gt;<i> /*--------------------------------------------------------------------------*/
</I>&gt;<i>      public String getFieldContents(int index);
</I>&gt;<i> -
</I>&gt;<i> +
</I>&gt;<i> +// These newly added fields are similar to the functionality provided
</I>&gt;<i> +// by the multiple validator support using the validator container.
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> /*---------------------------------------------------------------------------*/
</I>&gt;<i>      /**
</I>&gt;<i>       * Returns the field contents.
</I>&gt;<i> Index: src/lib/com/izforge/izpack/panels/UserInputPanel.java
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/lib/com/izforge/izpack/panels/UserInputPanel.java    (revision
</I>&gt;<i> 1998)
</I>&gt;<i> +++ src/lib/com/izforge/izpack/panels/UserInputPanel.java    (working
</I>&gt;<i> copy)
</I>&gt;<i> @@ -76,6 +76,8 @@
</I>&gt;<i>  import com.izforge.izpack.util.OsConstraint;
</I>&gt;<i>  import com.izforge.izpack.util.OsVersion;
</I>&gt;<i>  import com.izforge.izpack.util.VariableSubstitutor;
</I>&gt;<i> +import java.util.ArrayList;
</I>&gt;<i> +import java.util.List;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  /*---------------------------------------------------------------------------*/
</I>&gt;<i>  /**
</I>&gt;<i> @@ -1060,13 +1062,16 @@
</I>&gt;<i>                  File ffile = new File(file);
</I>&gt;<i>                  if (ffile.isDirectory()){
</I>&gt;<i>                      idata.setVariable((String) field[POS_VARIABLE],file);
</I>&gt;<i> +                    entries.add(new TextValuePair((String)
</I>&gt;<i> field[POS_VARIABLE],file));
</I>&gt;<i>                      return true;
</I>&gt;<i>                  }
</I>&gt;<i>                  else {
</I>&gt;<i> +                    showMessage(&quot;dir.notdirectory&quot;);
</I>&gt;<i>                      return false;
</I>&gt;<i>                  }
</I>&gt;<i>              }
</I>&gt;<i>              else {
</I>&gt;<i> +                showMessage(&quot;dir.nodirectory&quot;);
</I>&gt;<i>                  return false;
</I>&gt;<i>              }
</I>&gt;<i>          }
</I>&gt;<i> @@ -1078,6 +1083,13 @@
</I>&gt;<i>          }
</I>&gt;<i>      }
</I>&gt;<i>
</I>&gt;<i> +    private void showMessage(String messageType)
</I>&gt;<i> +    {
</I>&gt;<i> +        JOptionPane.showMessageDialog(parent, parent.langpack.getString(&quot;UserInputPanel.&quot;
</I>&gt;<i> + messageType + &quot;.message&quot;),
</I>&gt;<i> +                parent.langpack.getString(&quot;UserInputPanel.&quot; + messageType
</I>&gt;<i> + &quot;.caption&quot;),
</I>&gt;<i> +                JOptionPane.WARNING_MESSAGE);
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i>      private boolean readFileField(Object[] field)
</I>&gt;<i>      {
</I>&gt;<i>          try {
</I>&gt;<i> @@ -1088,13 +1100,16 @@
</I>&gt;<i>                  File ffile = new File(file);
</I>&gt;<i>                  if (ffile.isFile()){
</I>&gt;<i>                      idata.setVariable((String) field[POS_VARIABLE],file);
</I>&gt;<i> +                    entries.add(new TextValuePair((String)
</I>&gt;<i> field[POS_VARIABLE],file));
</I>&gt;<i>                      return true;
</I>&gt;<i>                  }
</I>&gt;<i>                  else {
</I>&gt;<i> +                    showMessage(&quot;file.notfile&quot;);
</I>&gt;<i>                      return false;
</I>&gt;<i>                  }
</I>&gt;<i>              }
</I>&gt;<i>              else {
</I>&gt;<i> +                showMessage(&quot;file.nofile&quot;);
</I>&gt;<i>                  return false;
</I>&gt;<i>              }
</I>&gt;<i>          }
</I>&gt;<i> @@ -1973,8 +1988,24 @@
</I>&gt;<i>       *        &amp;lt;processor
</I>&gt;<i> class=&amp;quot;com.izforge.sample.PWDEncryptor&amp;quot;/&amp;gt;
</I>&gt;<i>       *      &amp;lt;/field&amp;gt;
</I>&gt;<i>       *
</I>&gt;<i> +     * &lt;/pre&gt;
</I>&gt;<i> +     * Additionally, parameters and multiple validators can be used to
</I>&gt;<i> provide
</I>&gt;<i> +     * separate validation and error messages for each case.
</I>&gt;<i> +     * &lt;pre&gt;
</I>&gt;<i>       *
</I>&gt;<i> -     *
</I>&gt;<i> +     *    &amp;lt;field type=&amp;quot;password&amp;quot; align=&amp;quot;left&amp;quot;
</I>&gt;<i> variable=&amp;quot;keystore.password&amp;quot;&amp;gt;
</I>&gt;<i> +     *      &amp;lt;spec&amp;gt;
</I>&gt;<i> +     *        &amp;lt;pwd txt=&amp;quot;Keystore Password:&amp;quot;
</I>&gt;<i> size=&amp;quot;25&amp;quot; set=&amp;quot;&amp;quot;/&amp;gt;
</I>&gt;<i> +     *        &amp;lt;pwd txt=&amp;quot;Retype Password:&amp;quot;
</I>&gt;<i> size=&amp;quot;25&amp;quot; set=&amp;quot;&amp;quot;/&amp;gt;
</I>&gt;<i> +     *      &amp;lt;/spec&amp;gt;
</I>&gt;<i> +     *      &amp;lt;validator
</I>&gt;<i> class=&amp;quot;com.izforge.izpack.util.PasswordEqualityValidator&amp;quot;
</I>&gt;<i> txt=&amp;quot;Both keystore passwords must match.&amp;quot; id=&amp;quot;key for the
</I>&gt;<i> error text&amp;quot;/&amp;gt;
</I>&gt;<i> +     *      &amp;lt;validator
</I>&gt;<i> class=&amp;quot;com.izforge.izpack.util.PasswordKeystoreValidator&amp;quot;
</I>&gt;<i> txt=&amp;quot;Could not validate keystore with password and alias
</I>&gt;<i> provided.&amp;quot; id=&amp;quot;key for the error text&amp;quot;&amp;gt;
</I>&gt;<i> +     *        &amp;lt;param name=&amp;quot;keystoreFile&amp;quot; value=&amp;quot;${
</I>&gt;<i> existing.ssl.keystore}&amp;quot;/&amp;gt;
</I>&gt;<i> +     *        &amp;lt;param name=&amp;quot;keystoreType&amp;quot;
</I>&gt;<i> value=&amp;quot;JKS&amp;quot;/&amp;gt;
</I>&gt;<i> +     *        &amp;lt;param name=&amp;quot;keystoreAlias&amp;quot; value=&amp;quot;${
</I>&gt;<i> keystore.key.alias}&amp;quot;/&amp;gt;
</I>&gt;<i> +     *      &amp;lt;/validator&amp;gt;
</I>&gt;<i> +     *    &amp;lt;/field&amp;gt;
</I>&gt;<i> +     *
</I>&gt;<i>       * &lt;/pre&gt;
</I>&gt;<i>       *
</I>&gt;<i>       * @param spec a &lt;code&gt;XMLElement&lt;/code&gt; containing the specification
</I>&gt;<i> for the set of password
</I>&gt;<i> @@ -1986,12 +2017,15 @@
</I>&gt;<i>          Vector forPacks = spec.getChildrenNamed(SELECTEDPACKS);
</I>&gt;<i>          Vector forOs = spec.getChildrenNamed(OS);
</I>&gt;<i>          String variable = spec.getAttribute(VARIABLE);
</I>&gt;<i> -        String validator = null;
</I>&gt;<i>          String message = null;
</I>&gt;<i>          String processor = null;
</I>&gt;<i>          XMLElement element = null;
</I>&gt;<i>          PasswordGroup group = null;
</I>&gt;<i>          int size = 0;
</I>&gt;<i> +        // For multiple validator support
</I>&gt;<i> +        Vector validatorsElem = null;
</I>&gt;<i> +        List validatorsList = new ArrayList();
</I>&gt;<i> +        int vsize = 0;
</I>&gt;<i>
</I>&gt;<i>          // ----------------------------------------------------
</I>&gt;<i>          // get the description and add it to the list of UI
</I>&gt;<i> @@ -2003,11 +2037,36 @@
</I>&gt;<i>          // ----------------------------------------------------
</I>&gt;<i>          // get the validator and processor if they are defined
</I>&gt;<i>          // ----------------------------------------------------
</I>&gt;<i> -        element = spec.getFirstChildNamed(VALIDATOR);
</I>&gt;<i> -        if (element != null)
</I>&gt;<i> +
</I>&gt;<i> +        validatorsElem = spec.getChildrenNamed(VALIDATOR);
</I>&gt;<i> +        if (validatorsElem != null &amp;&amp; validatorsElem.size() &gt; 0)
</I>&gt;<i>          {
</I>&gt;<i> -            validator = element.getAttribute(CLASS);
</I>&gt;<i> -            message = getText(element);
</I>&gt;<i> +            vsize = validatorsElem.size();
</I>&gt;<i> +            for (int i = 0; i &lt; vsize; i++)
</I>&gt;<i> +            {
</I>&gt;<i> +                element = (XMLElement) validatorsElem.get(i);
</I>&gt;<i> +                String validator = element.getAttribute(CLASS);
</I>&gt;<i> +                message = getText(element);
</I>&gt;<i> +                HashMap validateParamMap = new HashMap();
</I>&gt;<i> +                //
</I>&gt;<i> ----------------------------------------------------------
</I>&gt;<i> +                // check and see if we have any parameters for this
</I>&gt;<i> validator.
</I>&gt;<i> +                // If so, then add them to validateParamMap.
</I>&gt;<i> +                //
</I>&gt;<i> ----------------------------------------------------------
</I>&gt;<i> +                Vector validateParams = element.getChildrenNamed
</I>&gt;<i> (RULE_PARAM);
</I>&gt;<i> +                if (validateParams != null &amp;&amp; validateParams.size() &gt; 0)
</I>&gt;<i> +                {
</I>&gt;<i> +                    Iterator iter = validateParams.iterator();
</I>&gt;<i> +                    while (iter.hasNext())
</I>&gt;<i> +                    {
</I>&gt;<i> +                        element = (XMLElement) iter.next();
</I>&gt;<i> +                        String paramName = element.getAttribute
</I>&gt;<i> (RULE_PARAM_NAME);
</I>&gt;<i> +                        String paramValue = element.getAttribute
</I>&gt;<i> (RULE_PARAM_VALUE);
</I>&gt;<i> +                        // System.out.println(&quot;Adding parameter:
</I>&gt;<i> &quot;+paramName+&quot;=&quot;+paramValue);
</I>&gt;<i> +                        validateParamMap.put(paramName, paramValue);
</I>&gt;<i> +                    }
</I>&gt;<i> +                }
</I>&gt;<i> +                validatorsList.add(new ValidatorContainer(validator,
</I>&gt;<i> message, validateParamMap));
</I>&gt;<i> +            }
</I>&gt;<i>          }
</I>&gt;<i>
</I>&gt;<i>          element = spec.getFirstChildNamed(PROCESSOR);
</I>&gt;<i> @@ -2016,7 +2075,7 @@
</I>&gt;<i>              processor = element.getAttribute(CLASS);
</I>&gt;<i>          }
</I>&gt;<i>
</I>&gt;<i> -        group = new PasswordGroup(validator, processor);
</I>&gt;<i> +        group = new PasswordGroup(idata, validatorsList, processor);
</I>&gt;<i>
</I>&gt;<i>          // ----------------------------------------------------
</I>&gt;<i>          // extract the specification details
</I>&gt;<i> @@ -2067,8 +2126,14 @@
</I>&gt;<i>                  TwoColumnConstraints constraints2 = new
</I>&gt;<i> TwoColumnConstraints();
</I>&gt;<i>                  constraints2.position = TwoColumnConstraints.EAST;
</I>&gt;<i>
</I>&gt;<i> -                uiElements.add(new Object[] { null, PWD_FIELD, variable,
</I>&gt;<i> constraints2, field,
</I>&gt;<i> -                        forPacks, forOs, null, null, message, group});
</I>&gt;<i> +                // Removed message to support pulling from multiple
</I>&gt;<i> validators
</I>&gt;<i> +                uiElements.add(new Object[]{null, PWD_FIELD, variable,
</I>&gt;<i> constraints2, field,
</I>&gt;<i> +                    forPacks, forOs, null, null, null, group
</I>&gt;<i> +                });
</I>&gt;<i> +                // Original
</I>&gt;<i> +//        uiElements.add(new Object[]{null, PWD_FIELD, variable,
</I>&gt;<i> constraints2, field,
</I>&gt;<i> +//          forPacks, forOs, null, null, message, group
</I>&gt;<i> +//        });
</I>&gt;<i>                  group.addField(field);
</I>&gt;<i>              }
</I>&gt;<i>          }
</I>&gt;<i> @@ -2097,7 +2162,8 @@
</I>&gt;<i>          {
</I>&gt;<i>              group = (PasswordGroup) field[POS_GROUP];
</I>&gt;<i>              variable = (String) field[POS_VARIABLE];
</I>&gt;<i> -            message = (String) field[POS_MESSAGE];
</I>&gt;<i> +        // Removed to support grabbing the message from multiple
</I>&gt;<i> validators
</I>&gt;<i> +        // message = (String) field[POS_MESSAGE];
</I>&gt;<i>          }
</I>&gt;<i>          catch (Throwable exception)
</I>&gt;<i>          {
</I>&gt;<i> @@ -2106,16 +2172,40 @@
</I>&gt;<i>          if ((variable == null) || (passwordGroupsRead.contains(group))) {
</I>&gt;<i> return (true); }
</I>&gt;<i>          passwordGroups.add(group);
</I>&gt;<i>
</I>&gt;<i> -        boolean success = !validating || group.validateContents();
</I>&gt;<i> +
</I>&gt;<i> +        //boolean success = !validating || group.validateContents();
</I>&gt;<i> +        boolean success = !validating;
</I>&gt;<i> +
</I>&gt;<i> +        // Use each validator to validate contents
</I>&gt;<i>          if (!success)
</I>&gt;<i>          {
</I>&gt;<i> -            showWarningMessageDialog(parentFrame, message);
</I>&gt;<i> -            return (false);
</I>&gt;<i> +            int size = group.validatorSize();
</I>&gt;<i> +            // System.out.println(&quot;Found &quot;+(size)+&quot; validators&quot;);
</I>&gt;<i> +            for (int i = 0; i &lt; size; i++)
</I>&gt;<i> +            {
</I>&gt;<i> +                success = group.validateContents(i);
</I>&gt;<i> +                if (!success)
</I>&gt;<i> +                {
</I>&gt;<i> +                    JOptionPane.showMessageDialog(parentFrame,
</I>&gt;<i> group.getValidatorMessage(i),
</I>&gt;<i> +                            parentFrame.langpack.getString(&quot;
</I>&gt;<i> UserInputPanel.error.caption&quot;),
</I>&gt;<i> +                            JOptionPane.WARNING_MESSAGE);
</I>&gt;<i> +                    break;
</I>&gt;<i> +                }
</I>&gt;<i> +            }
</I>&gt;<i>          }
</I>&gt;<i>
</I>&gt;<i> -        idata.setVariable(variable, group.getPassword());
</I>&gt;<i> -        entries.add(new TextValuePair(variable, group.getPassword()));
</I>&gt;<i> -        return (true);
</I>&gt;<i> +//    // Changed to show messages for each validator
</I>&gt;<i> +//    if (!success) {
</I>&gt;<i> +//      JOptionPane.showMessageDialog(parentFrame, message,
</I>&gt;<i> parentFrame.langpack.getString(&quot;UserInputPanel.error.caption&quot;),
</I>&gt;<i> JOptionPane.WARNING_MESSAGE);
</I>&gt;<i> +//      return (false);
</I>&gt;<i> +//    }
</I>&gt;<i> +
</I>&gt;<i> +        if (success)
</I>&gt;<i> +        {
</I>&gt;<i> +            idata.setVariable(variable, group.getPassword());
</I>&gt;<i> +            entries.add(new TextValuePair(variable, group.getPassword
</I>&gt;<i> ()));
</I>&gt;<i> +        }
</I>&gt;<i> +        return success;
</I>&gt;<i>      }
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> /*--------------------------------------------------------------------------*/
</I>&gt;<i> Index: src/lib/com/izforge/izpack/panels/UserPathInputPanel.java
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/lib/com/izforge/izpack/panels/UserPathInputPanel.java    (revision
</I>&gt;<i> 0)
</I>&gt;<i> +++ src/lib/com/izforge/izpack/panels/UserPathInputPanel.java    (revision
</I>&gt;<i> 0)
</I>&gt;<i> @@ -0,0 +1,422 @@
</I>&gt;<i> +/*
</I>&gt;<i> + * IzPack - Copyright 2001-2007 Julien Ponge, All Rights Reserved.
</I>&gt;<i> + *
</I>&gt;<i> + * <A HREF="https://izpack.github.io/">https://izpack.github.io/</A>
</I>&gt;<i> + * <A HREF="http://developer.berlios.de/projects/izpack/">http://developer.berlios.de/projects/izpack/</A>
</I>&gt;<i> + *
</I>&gt;<i> + * Copyright 2004 Klaus Bartz
</I>&gt;<i> + *
</I>&gt;<i> + * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
</I>&gt;<i> + * you may not use this file except in compliance with the License.
</I>&gt;<i> + * You may obtain a copy of the License at
</I>&gt;<i> + *
</I>&gt;<i> + *     <A HREF="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</A>
</I>&gt;<i> + *
</I>&gt;<i> + * Unless required by applicable law or agreed to in writing, software
</I>&gt;<i> + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
</I>&gt;<i> + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
</I>&gt;<i> implied.
</I>&gt;<i> + * See the License for the specific language governing permissions and
</I>&gt;<i> + * limitations under the License.
</I>&gt;<i> + */
</I>&gt;<i> +package com.izforge.izpack.panels;
</I>&gt;<i> +
</I>&gt;<i> +import java.awt.event.ActionEvent;
</I>&gt;<i> +import java.awt.event.ActionListener;
</I>&gt;<i> +import java.io.BufferedReader;
</I>&gt;<i> +import java.io.File;
</I>&gt;<i> +import java.io.IOException;
</I>&gt;<i> +import java.io.InputStream;
</I>&gt;<i> +import java.io.InputStreamReader;
</I>&gt;<i> +
</I>&gt;<i> +import com.izforge.izpack.gui.IzPanelLayout;
</I>&gt;<i> +import com.izforge.izpack.installer.InstallData;
</I>&gt;<i> +import com.izforge.izpack.installer.InstallerFrame;
</I>&gt;<i> +import com.izforge.izpack.installer.IzPanel;
</I>&gt;<i> +import com.izforge.izpack.installer.ResourceNotFoundException;
</I>&gt;<i> +import com.izforge.izpack.util.AbstractUIHandler;
</I>&gt;<i> +import com.izforge.izpack.util.Debug;
</I>&gt;<i> +import com.izforge.izpack.util.IoHelper;
</I>&gt;<i> +import com.izforge.izpack.util.OsVersion;
</I>&gt;<i> +import com.izforge.izpack.util.VariableSubstitutor;
</I>&gt;<i> +
</I>&gt;<i> +/**
</I>&gt;<i> + * Base class for panels which asks for paths.
</I>&gt;<i> + *
</I>&gt;<i> + * @author Klaus Bartz
</I>&gt;<i> + * @author Jeff Gordon
</I>&gt;<i> + *
</I>&gt;<i> + */
</I>&gt;<i> +public class UserPathInputPanel extends IzPanel implements ActionListener
</I>&gt;<i> {
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   *
</I>&gt;<i> +   */
</I>&gt;<i> +  private InstallerFrame _parent;
</I>&gt;<i> +  private InstallData _idata;
</I>&gt;<i> +  private static final long serialVersionUID = 3257566217698292531L;
</I>&gt;<i> +  /** Flag whether the choosen path must exist or not */
</I>&gt;<i> +  protected boolean _mustExist = false;
</I>&gt;<i> +  protected boolean _loadedDefaultDir = false;
</I>&gt;<i> +  /** Files which should be exist */
</I>&gt;<i> +  protected String[] _existFiles = null;
</I>&gt;<i> +  /** The path which was chosen */
</I>&gt;<i> +  // protected String chosenPath;
</I>&gt;<i> +  /** The path selection sub panel */
</I>&gt;<i> +  protected UserPathSelectionPanel _pathSelectionPanel;
</I>&gt;<i> +  protected String _error;
</I>&gt;<i> +  protected String _warn;
</I>&gt;<i> +  protected String _emptyTargetMsg;
</I>&gt;<i> +  protected String _warnMsg;
</I>&gt;<i> +  protected String _reqMsg;
</I>&gt;<i> +  protected String _notValidMsg;
</I>&gt;<i> +  protected String _notWritableMsg;
</I>&gt;<i> +  protected String _createDirMsg;
</I>&gt;<i> +  protected String _defaultDir = null;
</I>&gt;<i> +  protected String _thisPanel = &quot;UserPathInputPanel&quot;;
</I>&gt;<i> +  protected String _defaultPanelName = &quot;TargetPanel&quot;;
</I>&gt;<i> +  protected String _targetPanel = &quot;UserPathPanel&quot;;
</I>&gt;<i> +  protected String _variableName = &quot;pathVariable&quot;;
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * The constructor.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param parent The parent window.
</I>&gt;<i> +   * @param idata The installation data.
</I>&gt;<i> +   */
</I>&gt;<i> +  public UserPathInputPanel(InstallerFrame parent, InstallData idata,
</I>&gt;<i> String targetPanel, String variableName) {
</I>&gt;<i> +    super(parent, idata, new IzPanelLayout());
</I>&gt;<i> +    _parent = parent;
</I>&gt;<i> +    _idata = idata;
</I>&gt;<i> +    _targetPanel = targetPanel;
</I>&gt;<i> +    _variableName = variableName;
</I>&gt;<i> +    // Set default values
</I>&gt;<i> +    loadMessages();
</I>&gt;<i> +    String introText = getI18nStringForClass(&quot;extendedIntro&quot;,
</I>&gt;<i> _thisPanel);
</I>&gt;<i> +    if (introText == null || introText.endsWith(&quot;extendedIntro&quot;) ||
</I>&gt;<i> introText.indexOf('$') &gt; -1) {
</I>&gt;<i> +      introText = getI18nStringForClass(&quot;intro&quot;, _thisPanel);
</I>&gt;<i> +      if (introText == null || introText.endsWith(&quot;intro&quot;)) {
</I>&gt;<i> +        introText = &quot;&quot;;
</I>&gt;<i> +      }
</I>&gt;<i> +    }
</I>&gt;<i> +    // Intro
</I>&gt;<i> +    // row 0 column 0
</I>&gt;<i> +    add(createMultiLineLabel(introText));
</I>&gt;<i> +    add(IzPanelLayout.createParagraphGap());
</I>&gt;<i> +    // Label for input
</I>&gt;<i> +    // row 1 column 0.
</I>&gt;<i> +    add(createLabel(&quot;info&quot;, _targetPanel, &quot;open&quot;, LEFT, true),
</I>&gt;<i> NEXT_LINE);
</I>&gt;<i> +    // Create path selection components and add they to this panel.
</I>&gt;<i> +    _pathSelectionPanel = new UserPathSelectionPanel(this, idata,
</I>&gt;<i> _targetPanel, _variableName);
</I>&gt;<i> +    add(_pathSelectionPanel, NEXT_LINE);
</I>&gt;<i> +    createLayoutBottom();
</I>&gt;<i> +    getLayoutHelper().completeLayout();
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * This method does nothing. It is called from ctor of
</I>&gt;<i> UserPathInputPanel, to give in a derived
</I>&gt;<i> +   * class the possibility to add more components under the path input
</I>&gt;<i> components.
</I>&gt;<i> +   */
</I>&gt;<i> +  public void createLayoutBottom() {
</I>&gt;<i> +  // Derived classes implements additional elements.
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Actions-handling method.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param e The event.
</I>&gt;<i> +   */
</I>&gt;<i> +  public void actionPerformed(ActionEvent e) {
</I>&gt;<i> +    Object source = e.getSource();
</I>&gt;<i> +    if (source == _pathSelectionPanel.getPathInputField()) {
</I>&gt;<i> +      parent.navigateNext();
</I>&gt;<i> +    }
</I>&gt;<i> +
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  private void loadMessages() {
</I>&gt;<i> +    _error = parent.langpack.getString(&quot;installer.error&quot;);
</I>&gt;<i> +    _warn = parent.langpack.getString(&quot;installer.warning&quot;);
</I>&gt;<i> +    _reqMsg = getMessage(&quot;required&quot;);
</I>&gt;<i> +    _emptyTargetMsg = getMessage(&quot;empty_target&quot;);
</I>&gt;<i> +    _warnMsg = getMessage(&quot;exists_warn&quot;);
</I>&gt;<i> +    _notValidMsg = getMessage(&quot;notValid&quot;);
</I>&gt;<i> +    _notWritableMsg = getMessage(&quot;notwritable&quot;);
</I>&gt;<i> +    _createDirMsg = getMessage(&quot;createdir&quot;);
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  private String getMessage(String type) {
</I>&gt;<i> +    String msg = null;
</I>&gt;<i> +    msg = getI18nStringForClass(type, _targetPanel);
</I>&gt;<i> +    if (msg == null) {
</I>&gt;<i> +      msg = getI18nStringForClass(type, _defaultPanelName);
</I>&gt;<i> +    }
</I>&gt;<i> +    return msg;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Indicates whether the panel has been validated or not.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @return Whether the panel has been validated or not.
</I>&gt;<i> +   */
</I>&gt;<i> +  public boolean isValidated() {
</I>&gt;<i> +    String chosenPath = _pathSelectionPanel.getPath();
</I>&gt;<i> +    boolean ok = true;
</I>&gt;<i> +    // We put a warning if the specified target is nameless
</I>&gt;<i> +    if (chosenPath.length() == 0) {
</I>&gt;<i> +      if (isMustExist()) {
</I>&gt;<i> +        emitError(_error, _reqMsg);
</I>&gt;<i> +        return false;
</I>&gt;<i> +      }
</I>&gt;<i> +      ok = emitWarning(_warn, _emptyTargetMsg);
</I>&gt;<i> +    }
</I>&gt;<i> +    if (!ok) {
</I>&gt;<i> +      return ok;
</I>&gt;<i> +    }
</I>&gt;<i> +    // Normalize the path
</I>&gt;<i> +    File path = new File(chosenPath).getAbsoluteFile();
</I>&gt;<i> +    chosenPath = path.toString();
</I>&gt;<i> +    _pathSelectionPanel.setPath(chosenPath);
</I>&gt;<i> +    if (isMustExist()) {
</I>&gt;<i> +      if (!path.exists()) {
</I>&gt;<i> +        emitError(_error, _reqMsg);
</I>&gt;<i> +        return false;
</I>&gt;<i> +      }
</I>&gt;<i> +      if (!pathIsValid()) {
</I>&gt;<i> +        emitError(_error, _notValidMsg);
</I>&gt;<i> +        return false;
</I>&gt;<i> +      }
</I>&gt;<i> +    } else {
</I>&gt;<i> +      // We assume, that we would install something into this dir
</I>&gt;<i> +      if (!isWriteable()) {
</I>&gt;<i> +        emitError(_error, _notWritableMsg);
</I>&gt;<i> +        return false;
</I>&gt;<i> +      }
</I>&gt;<i> +      // We put a warning if the directory exists else we warn
</I>&gt;<i> +      // that it will be created
</I>&gt;<i> +      if (path.exists()) {
</I>&gt;<i> +        int res = askQuestion(_warn, _warnMsg,
</I>&gt;<i> +                AbstractUIHandler.CHOICES_YES_NO,
</I>&gt;<i> AbstractUIHandler.ANSWER_YES);
</I>&gt;<i> +        ok = res == AbstractUIHandler.ANSWER_YES;
</I>&gt;<i> +      } else {
</I>&gt;<i> +        ok = this.emitNotificationFeedback(_createDirMsg + &quot;\n&quot; +
</I>&gt;<i> chosenPath);
</I>&gt;<i> +      }
</I>&gt;<i> +    }
</I>&gt;<i> +    return ok;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Returns whether the chosen path is true or not. If existFiles are
</I>&gt;<i> not null, the existence of
</I>&gt;<i> +   * it under the choosen path are detected. This method can be also
</I>&gt;<i> implemented in derived
</I>&gt;<i> +   * classes to handle special verification of the path.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @return true if existFiles are exist or not defined, else false
</I>&gt;<i> +   */
</I>&gt;<i> +  protected boolean pathIsValid() {
</I>&gt;<i> +    if (_existFiles == null) {
</I>&gt;<i> +      return true;
</I>&gt;<i> +    }
</I>&gt;<i> +    for (int i = 0; i &lt; _existFiles.length; ++i) {
</I>&gt;<i> +      File path = new File(_pathSelectionPanel.getPath(),
</I>&gt;<i> _existFiles[i]).getAbsoluteFile();
</I>&gt;<i> +      if (!path.exists()) {
</I>&gt;<i> +        return false;
</I>&gt;<i> +      }
</I>&gt;<i> +    }
</I>&gt;<i> +    return true;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Returns the must exist state.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @return the must exist state
</I>&gt;<i> +   */
</I>&gt;<i> +  public boolean isMustExist() {
</I>&gt;<i> +    return _mustExist;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Sets the must exist state. If it is true, the path must exist.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param b must exist state
</I>&gt;<i> +   */
</I>&gt;<i> +  public void setMustExist(boolean b) {
</I>&gt;<i> +    _mustExist = b;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Returns the array of strings which are described the files which
</I>&gt;<i> must exist.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @return paths of files which must exist
</I>&gt;<i> +   */
</I>&gt;<i> +  public String[] getExistFiles() {
</I>&gt;<i> +    return _existFiles;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Sets the paths of files which must exist under the chosen path.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param strings paths of files which must exist under the chosen path
</I>&gt;<i> +   */
</I>&gt;<i> +  public void setExistFiles(String[] strings) {
</I>&gt;<i> +    _existFiles = strings;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * &quot;targetPanel&quot; is typically the class name of the implementing panel,
</I>&gt;<i> such as
</I>&gt;<i> +   * &quot;UserPathPanel&quot; or &quot;TargetPanel&quot; set when the class is created, but
</I>&gt;<i> can be set
</I>&gt;<i> +   * with setDefaultDir().
</I>&gt;<i> +   * Loads up the &quot;dir&quot; resource associated with targetPanel. Acceptable
</I>&gt;<i> dir resource names:
</I>&gt;<i> +   * &lt;code&gt;
</I>&gt;<i> +   *   targetPanel.dir.macosx
</I>&gt;<i> +   *   targetPanel.dir.mac
</I>&gt;<i> +   *   targetPanel.dir.windows
</I>&gt;<i> +   *   targetPanel.dir.unix
</I>&gt;<i> +   *   targetPanel.dir.xxx,
</I>&gt;<i> +   *     where xxx is the lower case version of System.getProperty(&quot;
</I>&gt;<i> os.name&quot;),
</I>&gt;<i> +   *     with any spaces replace with underscores
</I>&gt;<i> +   *   targetPanel.dir (generic that will be applied if none of above is
</I>&gt;<i> found)
</I>&gt;<i> +   *   &lt;/code&gt;
</I>&gt;<i> +   * As with all IzPack resources, each the above ids should be
</I>&gt;<i> associated with a separate
</I>&gt;<i> +   * filename, which is set in the install.xml file at compile time.
</I>&gt;<i> +   */
</I>&gt;<i> +  private void loadDefaultDir() {
</I>&gt;<i> +    // Load only once ...
</I>&gt;<i> +    if (!(_loadedDefaultDir)) {
</I>&gt;<i> +      BufferedReader br = null;
</I>&gt;<i> +      try {
</I>&gt;<i> +        InputStream in = null;
</I>&gt;<i> +        if (OsVersion.IS_WINDOWS) {
</I>&gt;<i> +          try {
</I>&gt;<i> +            in = _parent.getResource(_targetPanel + &quot;.dir.windows&quot;);
</I>&gt;<i> +          } catch (ResourceNotFoundException rnfe) {
</I>&gt;<i> +          }//it's usual, that the resource does not exist
</I>&gt;<i> +        } else if (OsVersion.IS_OSX) {
</I>&gt;<i> +          try {
</I>&gt;<i> +            in = _parent.getResource(_targetPanel + &quot;.dir.macosx&quot;);
</I>&gt;<i> +          } catch (ResourceNotFoundException rnfe) {
</I>&gt;<i> +          }//it's usual, that the resource does not exist
</I>&gt;<i> +        } else {
</I>&gt;<i> +          String os = System.getProperty(&quot;os.name&quot;);
</I>&gt;<i> +          // first try to look up by specific os name
</I>&gt;<i> +          os = os.replace(' ', '_'); // avoid spaces in file names
</I>&gt;<i> +          os = os.toLowerCase(); // for consistency among targetPanel res
</I>&gt;<i> files
</I>&gt;<i> +          try {
</I>&gt;<i> +            in = _parent.getResource(_targetPanel + &quot;.dir.&quot;.concat(os));
</I>&gt;<i> +          } catch (ResourceNotFoundException rnfe) {
</I>&gt;<i> +          }
</I>&gt;<i> +          // if not specific os, try getting generic 'unix' resource file
</I>&gt;<i> +          if (in == null) {
</I>&gt;<i> +            try {
</I>&gt;<i> +              in = _parent.getResource(_targetPanel + &quot;.dir.unix&quot;);
</I>&gt;<i> +            } catch (ResourceNotFoundException eee) {
</I>&gt;<i> +            }
</I>&gt;<i> +          }
</I>&gt;<i> +        }
</I>&gt;<i> +        // if all above tests failed, there is no resource file,
</I>&gt;<i> +        // so use system default
</I>&gt;<i> +        if (in == null) {
</I>&gt;<i> +          try {
</I>&gt;<i> +            in = _parent.getResource(_targetPanel + &quot;.dir&quot;);
</I>&gt;<i> +          } catch (ResourceNotFoundException eee) {
</I>&gt;<i> +          }
</I>&gt;<i> +        }
</I>&gt;<i> +        if (in != null) {
</I>&gt;<i> +          // now read the file, once we've identified which one to read
</I>&gt;<i> +          InputStreamReader isr = new InputStreamReader(in);
</I>&gt;<i> +          br = new BufferedReader(isr);
</I>&gt;<i> +          String line;
</I>&gt;<i> +          while ((line = br.readLine()) != null) {
</I>&gt;<i> +            line = line.trim();
</I>&gt;<i> +            // use the first non-blank line
</I>&gt;<i> +            if (!&quot;&quot;.equals(line)) {
</I>&gt;<i> +              break;
</I>&gt;<i> +            }
</I>&gt;<i> +          }
</I>&gt;<i> +          _defaultDir = line;
</I>&gt;<i> +          VariableSubstitutor vs = new VariableSubstitutor(
</I>&gt;<i> idata.getVariables());
</I>&gt;<i> +          _defaultDir = vs.substitute(_defaultDir, null);
</I>&gt;<i> +        }
</I>&gt;<i> +      } catch (Exception e) {
</I>&gt;<i> +        //mar: what's the common way to log an exception ?
</I>&gt;<i> +        e.printStackTrace();
</I>&gt;<i> +        _defaultDir = null;
</I>&gt;<i> +      // leave unset to take the system default set by Installer class
</I>&gt;<i> +      } finally {
</I>&gt;<i> +        try {
</I>&gt;<i> +          if (br != null) {
</I>&gt;<i> +            br.close();
</I>&gt;<i> +          }
</I>&gt;<i> +        } catch (IOException ignored) {
</I>&gt;<i> +        }
</I>&gt;<i> +      }
</I>&gt;<i> +    }
</I>&gt;<i> +    _loadedDefaultDir = true;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * This method determines whether the chosen dir is writeable or not.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @return whether the chosen dir is writeable or not
</I>&gt;<i> +   */
</I>&gt;<i> +  public boolean isWriteable() {
</I>&gt;<i> +    File existParent = IoHelper.existingParent(new
</I>&gt;<i> File(_pathSelectionPanel.getPath()));
</I>&gt;<i> +    if (existParent == null) {
</I>&gt;<i> +      return false;
</I>&gt;<i> +    }
</I>&gt;<i> +    // On windows we cannot use canWrite because
</I>&gt;<i> +    // it looks to the dos flags which are not valid
</I>&gt;<i> +    // on NT or 2k XP or ...
</I>&gt;<i> +    if (OsVersion.IS_WINDOWS) {
</I>&gt;<i> +      File tmpFile;
</I>&gt;<i> +      try {
</I>&gt;<i> +        tmpFile = File.createTempFile(&quot;izWrTe&quot;, &quot;.tmp&quot;, existParent);
</I>&gt;<i> +        tmpFile.deleteOnExit();
</I>&gt;<i> +      } catch (IOException e) {
</I>&gt;<i> +        Debug.trace(e.toString());
</I>&gt;<i> +        return false;
</I>&gt;<i> +      }
</I>&gt;<i> +      return true;
</I>&gt;<i> +    }
</I>&gt;<i> +    return existParent.canWrite();
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Returns the default for the directory.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @return the default for the directory
</I>&gt;<i> +   */
</I>&gt;<i> +  public String getDefaultDir() {
</I>&gt;<i> +    if (_defaultDir == null &amp;&amp; (!(_loadedDefaultDir))) {
</I>&gt;<i> +      loadDefaultDir();
</I>&gt;<i> +    }
</I>&gt;<i> +    return _defaultDir;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Sets the default for the directory to the given string.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param string path for default directory
</I>&gt;<i> +   */
</I>&gt;<i> +  public void setDefaultDir(String string) {
</I>&gt;<i> +    _defaultDir = string;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Returns the panel name extending this class.
</I>&gt;<i> +   * Used for looking up localized text and resources.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @return the default for the directory
</I>&gt;<i> +   */
</I>&gt;<i> +  public String getTargetPanel() {
</I>&gt;<i> +    return _targetPanel;
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Sets the panel name extending this class.
</I>&gt;<i> +   * Used for looking up localized text and resources.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param string path for default directory
</I>&gt;<i> +   */
</I>&gt;<i> +  public void setTargetPanel(String string) {
</I>&gt;<i> +    _targetPanel = string;
</I>&gt;<i> +  }
</I>&gt;<i> +}
</I>&gt;<i> Index: src/lib/com/izforge/izpack/panels/UserPathPanel.java
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/lib/com/izforge/izpack/panels/UserPathPanel.java    (revision 0)
</I>&gt;<i> +++ src/lib/com/izforge/izpack/panels/UserPathPanel.java    (revision 0)
</I>&gt;<i> @@ -0,0 +1,138 @@
</I>&gt;<i> +/*
</I>&gt;<i> + * IzPack - Copyright 2001-2007 Julien Ponge, All Rights Reserved.
</I>&gt;<i> + *
</I>&gt;<i> + * <A HREF="https://izpack.github.io/">https://izpack.github.io/</A>
</I>&gt;<i> + * <A HREF="http://developer.berlios.de/projects/izpack/">http://developer.berlios.de/projects/izpack/</A>
</I>&gt;<i> + *
</I>&gt;<i> + * Copyright 2004 Klaus Bartz
</I>&gt;<i> + *
</I>&gt;<i> + * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
</I>&gt;<i> + * you may not use this file except in compliance with the License.
</I>&gt;<i> + * You may obtain a copy of the License at
</I>&gt;<i> + *
</I>&gt;<i> + *     <A HREF="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</A>
</I>&gt;<i> + *
</I>&gt;<i> + * Unless required by applicable law or agreed to in writing, software
</I>&gt;<i> + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
</I>&gt;<i> + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
</I>&gt;<i> implied.
</I>&gt;<i> + * See the License for the specific language governing permissions and
</I>&gt;<i> + * limitations under the License.
</I>&gt;<i> + */
</I>&gt;<i> +package com.izforge.izpack.panels;
</I>&gt;<i> +
</I>&gt;<i> +import com.izforge.izpack.Pack;
</I>&gt;<i> +import net.n3.nanoxml.XMLElement;
</I>&gt;<i> +
</I>&gt;<i> +import com.izforge.izpack.installer.InstallData;
</I>&gt;<i> +import com.izforge.izpack.installer.InstallerFrame;
</I>&gt;<i> +import com.izforge.izpack.util.AbstractUIHandler;
</I>&gt;<i> +import com.izforge.izpack.util.Debug;
</I>&gt;<i> +import com.izforge.izpack.util.OsConstraint;
</I>&gt;<i> +import java.util.ArrayList;
</I>&gt;<i> +import java.util.HashMap;
</I>&gt;<i> +import java.util.Iterator;
</I>&gt;<i> +
</I>&gt;<i> +/**
</I>&gt;<i> + * The taget directory selection panel.
</I>&gt;<i> + *
</I>&gt;<i> + * @author Julien Ponge
</I>&gt;<i> + * @author Jeff Gordon
</I>&gt;<i> + */
</I>&gt;<i> +public class UserPathPanel extends UserPathInputPanel {
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   *
</I>&gt;<i> +   */
</I>&gt;<i> +  private static final long serialVersionUID = 3256443616359429170L;
</I>&gt;<i> +  private static String thisName = &quot;UserPathPanel&quot;;
</I>&gt;<i> +  private boolean _skip = false;
</I>&gt;<i> +  public static String pathVariableName = &quot;UserPathPanelVariable&quot;;
</I>&gt;<i> +  public static String pathPackDependsName = &quot;UserPathPanelDependsName&quot;;
</I>&gt;<i> +  public static String pathElementName = &quot;UserPathPanelElement&quot;;
</I>&gt;<i> +  private XMLElement panelElement;
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * The constructor.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param parent The parent window.
</I>&gt;<i> +   * @param idata The installation data.
</I>&gt;<i> +   */
</I>&gt;<i> +  public UserPathPanel(InstallerFrame parent, InstallData idata) {
</I>&gt;<i> +    super(parent, idata, thisName, parent.langpack.getString
</I>&gt;<i> (thisName+&quot;.variableName&quot;));
</I>&gt;<i> +    // load the default directory info (if present)
</I>&gt;<i> +    if (getDefaultDir() != null) {
</I>&gt;<i> +      idata.setVariable(pathVariableName, getDefaultDir());
</I>&gt;<i> +    }
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /** Called when the panel becomes active. */
</I>&gt;<i> +  public void panelActivate() {
</I>&gt;<i> +    boolean found = false;
</I>&gt;<i> +    System.out.println(thisName+&quot; looking for activation condition&quot;);
</I>&gt;<i> +    // Need to have a way to supress panel if not in selected packs.
</I>&gt;<i> +    String dependsName = idata.getVariable(pathPackDependsName);
</I>&gt;<i> +    if (dependsName!=null &amp;&amp; !(dependsName.equalsIgnoreCase(&quot;&quot;))) {
</I>&gt;<i> +      System.out.println(&quot;Checking for pack dependency of &quot;+dependsName);
</I>&gt;<i> +      Iterator iter = idata.selectedPacks.iterator();
</I>&gt;<i> +      while (iter.hasNext()) {
</I>&gt;<i> +        Pack pack = (Pack)iter.next();
</I>&gt;<i> +        System.out.println(&quot;- Checking if &quot;+pack.name+&quot; equals
</I>&gt;<i> &quot;+dependsName);
</I>&gt;<i> +        if (pack.name.equalsIgnoreCase(dependsName)) {
</I>&gt;<i> +          found = true;
</I>&gt;<i> +          System.out.println(&quot;-- Found &quot;+dependsName+&quot;, panel will be
</I>&gt;<i> shown&quot;);
</I>&gt;<i> +          break;
</I>&gt;<i> +        }
</I>&gt;<i> +      }
</I>&gt;<i> +      _skip = !(found);
</I>&gt;<i> +    } else {
</I>&gt;<i> +      System.out.println(&quot;Not Checking for a pack dependency, panel will
</I>&gt;<i> be shown&quot;);
</I>&gt;<i> +      _skip = false;
</I>&gt;<i> +    }
</I>&gt;<i> +    if (_skip) {
</I>&gt;<i> +      System.out.println(thisName+&quot; will not be shown&quot;);
</I>&gt;<i> +      parent.skipPanel();
</I>&gt;<i> +      return;
</I>&gt;<i> +    }
</I>&gt;<i> +    super.panelActivate();
</I>&gt;<i> +    // Set the default or old value to the path selection panel.
</I>&gt;<i> +    _pathSelectionPanel.setPath(idata.getVariable(pathVariableName));
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Indicates whether the panel has been validated or not.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @return Whether the panel has been validated or not.
</I>&gt;<i> +   */
</I>&gt;<i> +  public boolean isValidated() {
</I>&gt;<i> +    // Standard behavior of PathInputPanel.
</I>&gt;<i> +    if (!super.isValidated()) {
</I>&gt;<i> +      return (false);
</I>&gt;<i> +    }
</I>&gt;<i> +    idata.setVariable(pathVariableName, _pathSelectionPanel.getPath());
</I>&gt;<i> +    return (true);
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Asks to make the XML panel data.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param panelRoot The tree to put the data in.
</I>&gt;<i> +   */
</I>&gt;<i> +  public void makeXMLData(XMLElement panelRoot) {
</I>&gt;<i> +    if (!(_skip)) {
</I>&gt;<i> +      new UserPathPanelAutomationHelper().makeXMLData(idata, panelRoot);
</I>&gt;<i> +    }
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /*
</I>&gt;<i> +   * (non-Javadoc)
</I>&gt;<i> +   *
</I>&gt;<i> +   * @see com.izforge.izpack.installer.IzPanel#getSummaryBody()
</I>&gt;<i> +   */
</I>&gt;<i> +  public String getSummaryBody() {
</I>&gt;<i> +    if (_skip) {
</I>&gt;<i> +      return null;
</I>&gt;<i> +    } else {
</I>&gt;<i> +      return (idata.getVariable(pathVariableName));
</I>&gt;<i> +    }
</I>&gt;<i> +  }
</I>&gt;<i> +}
</I>&gt;<i> Index:
</I>&gt;<i> src/lib/com/izforge/izpack/panels/UserPathPanelAutomationHelper.java
</I>&gt;<i> ===================================================================
</I>&gt;<i> ---
</I>&gt;<i> src/lib/com/izforge/izpack/panels/UserPathPanelAutomationHelper.java
</I>&gt;<i> (revision 0)
</I>&gt;<i> +++
</I>&gt;<i> src/lib/com/izforge/izpack/panels/UserPathPanelAutomationHelper.java
</I>&gt;<i> (revision 0)
</I>&gt;<i> @@ -0,0 +1,77 @@
</I>&gt;<i> +/*
</I>&gt;<i> + * IzPack - Copyright 2001-2007 Julien Ponge, All Rights Reserved.
</I>&gt;<i> + *
</I>&gt;<i> + * <A HREF="https://izpack.github.io/">https://izpack.github.io/</A>
</I>&gt;<i> + * <A HREF="http://developer.berlios.de/projects/izpack/">http://developer.berlios.de/projects/izpack/</A>
</I>&gt;<i> + *
</I>&gt;<i> + * Copyright 2003 Jonathan Halliday
</I>&gt;<i> + *
</I>&gt;<i> + * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
</I>&gt;<i> + * you may not use this file except in compliance with the License.
</I>&gt;<i> + * You may obtain a copy of the License at
</I>&gt;<i> + *
</I>&gt;<i> + *     <A HREF="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</A>
</I>&gt;<i> + *
</I>&gt;<i> + * Unless required by applicable law or agreed to in writing, software
</I>&gt;<i> + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
</I>&gt;<i> + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
</I>&gt;<i> implied.
</I>&gt;<i> + * See the License for the specific language governing permissions and
</I>&gt;<i> + * limitations under the License.
</I>&gt;<i> + */
</I>&gt;<i> +package com.izforge.izpack.panels;
</I>&gt;<i> +
</I>&gt;<i> +import net.n3.nanoxml.XMLElement;
</I>&gt;<i> +import com.izforge.izpack.installer.AutomatedInstallData;
</I>&gt;<i> +import com.izforge.izpack.installer.PanelAutomation;
</I>&gt;<i> +import com.izforge.izpack.util.VariableSubstitutor;
</I>&gt;<i> +
</I>&gt;<i> +/**
</I>&gt;<i> + * Functions to support automated usage of the UserPathPanel
</I>&gt;<i> + *
</I>&gt;<i> + * @author Jonathan Halliday
</I>&gt;<i> + * @author Julien Ponge
</I>&gt;<i> + * @author Jeff Gordon
</I>&gt;<i> + */
</I>&gt;<i> +public class UserPathPanelAutomationHelper implements PanelAutomation {
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Asks to make the XML panel data.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param idata The installation data.
</I>&gt;<i> +   * @param panelRoot The tree to put the data in.
</I>&gt;<i> +   */
</I>&gt;<i> +  public void makeXMLData(AutomatedInstallData idata, XMLElement
</I>&gt;<i> panelRoot) {
</I>&gt;<i> +    // Installation path markup
</I>&gt;<i> +    XMLElement ipath = new XMLElement(UserPathPanel.pathElementName);
</I>&gt;<i> +    // check this writes even if value is the default,
</I>&gt;<i> +    // because without the constructor, default does not get set.
</I>&gt;<i> +    ipath.setContent(idata.getVariable(UserPathPanel.pathVariableName));
</I>&gt;<i> +
</I>&gt;<i> +    // Checkings to fix bug #1864
</I>&gt;<i> +    XMLElement prev = panelRoot.getFirstChildNamed(
</I>&gt;<i> UserPathPanel.pathElementName);
</I>&gt;<i> +    if (prev != null) {
</I>&gt;<i> +      panelRoot.removeChild(prev);
</I>&gt;<i> +    }
</I>&gt;<i> +    panelRoot.addChild(ipath);
</I>&gt;<i> +  }
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   * Asks to run in the automated mode.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @param idata The installation data.
</I>&gt;<i> +   * @param panelRoot The XML tree to read the data from.
</I>&gt;<i> +   *
</I>&gt;<i> +   * @return always true.
</I>&gt;<i> +   */
</I>&gt;<i> +  public boolean runAutomated(AutomatedInstallData idata, XMLElement
</I>&gt;<i> panelRoot) {
</I>&gt;<i> +    // We set the installation path
</I>&gt;<i> +    XMLElement ipath = panelRoot.getFirstChildNamed(
</I>&gt;<i> UserPathPanel.pathElementName);
</I>&gt;<i> +
</I>&gt;<i> +    // Allow for variable substitution of the installpath value
</I>&gt;<i> +    VariableSubstitutor vs = new VariableSubstitutor(idata.getVariables
</I>&gt;<i> ());
</I>&gt;<i> +    String path = ipath.getContent();
</I>&gt;<i> +    path = vs.substitute(path, null);
</I>&gt;<i> +    idata.setVariable(UserPathPanel.pathVariableName, path);
</I>&gt;<i> +    return true;
</I>&gt;<i> +  }
</I>&gt;<i> +}
</I>&gt;<i> Index: src/lib/com/izforge/izpack/panels/UserPathSelectionPanel.java
</I>&gt;<i> ===================================================================
</I>&gt;<i> --- src/lib/com/izforge/izpack/panels/UserPathSelectionPanel.java
</I>&gt;<i> (revision 0)
</I>&gt;<i> +++ src/lib/com/izforge/izpack/panels/UserPathSelectionPanel.java
</I>&gt;<i> (revision 0)
</I>&gt;<i> @@ -0,0 +1,197 @@
</I>&gt;<i> +/*
</I>&gt;<i> + * IzPack - Copyright 2001-2007 Julien Ponge, All Rights Reserved.
</I>&gt;<i> + *
</I>&gt;<i> + * <A HREF="https://izpack.github.io/">https://izpack.github.io/</A>
</I>&gt;<i> + * <A HREF="http://developer.berlios.de/projects/izpack/">http://developer.berlios.de/projects/izpack/</A>
</I>&gt;<i> + *
</I>&gt;<i> + * Copyright 2004 Klaus Bartz
</I>&gt;<i> + *
</I>&gt;<i> + * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
</I>&gt;<i> + * you may not use this file except in compliance with the License.
</I>&gt;<i> + * You may obtain a copy of the License at
</I>&gt;<i> + *
</I>&gt;<i> + *     <A HREF="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</A>
</I>&gt;<i> + *
</I>&gt;<i> + * Unless required by applicable law or agreed to in writing, software
</I>&gt;<i> + * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
</I>&gt;<i> + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
</I>&gt;<i> implied.
</I>&gt;<i> + * See the License for the specific language governing permissions and
</I>&gt;<i> + * limitations under the License.
</I>&gt;<i> + */
</I>&gt;<i> +package com.izforge.izpack.panels;
</I>&gt;<i> +
</I>&gt;<i> +import java.awt.Dimension;
</I>&gt;<i> +import java.awt.event.ActionEvent;
</I>&gt;<i> +import java.awt.event.ActionListener;
</I>&gt;<i> +import java.io.File;
</I>&gt;<i> +
</I>&gt;<i> +import javax.swing.JButton;
</I>&gt;<i> +import javax.swing.JFileChooser;
</I>&gt;<i> +import javax.swing.JPanel;
</I>&gt;<i> +import javax.swing.JTextField;
</I>&gt;<i> +
</I>&gt;<i> +import com.izforge.izpack.gui.ButtonFactory;
</I>&gt;<i> +import com.izforge.izpack.gui.IzPanelConstraints;
</I>&gt;<i> +import com.izforge.izpack.gui.IzPanelLayout;
</I>&gt;<i> +import com.izforge.izpack.gui.LayoutConstants;
</I>&gt;<i> +import com.izforge.izpack.installer.InstallData;
</I>&gt;<i> +import com.izforge.izpack.installer.IzPanel;
</I>&gt;<i> +import com.izforge.izpack.installer.LayoutHelper;
</I>&gt;<i> +
</I>&gt;<i> +/**
</I>&gt;<i> + * This is a sub panel which contains a text field and a browse button
</I>&gt;<i> for path selection. This is
</I>&gt;<i> + * NOT an IzPanel, else it is made to use in an IzPanel for any path
</I>&gt;<i> selection. If the IzPanel
</I>&gt;<i> + * parent implements ActionListener, the ActionPerformed method will be
</I>&gt;<i> called, if
</I>&gt;<i> + * PathSelectionPanel.ActionPerformed was called with a source other than
</I>&gt;<i> the browse button. This
</I>&gt;<i> + * can be used to perform parentFrame.navigateNext in the IzPanel parent.
</I>&gt;<i> An example implementation
</I>&gt;<i> + * is done in com.izforge.izpack.panels.PathInputPanel.
</I>&gt;<i> + *
</I>&gt;<i> + * @author Klaus Bartz
</I>&gt;<i> + * @author Jeff Gordon
</I>&gt;<i> + *
</I>&gt;<i> + */
</I>&gt;<i> +public class UserPathSelectionPanel extends JPanel implements
</I>&gt;<i> ActionListener, LayoutConstants {
</I>&gt;<i> +
</I>&gt;<i> +  /**
</I>&gt;<i> +   *
</I>&gt;<i> +   */
</I>&gt;<i> +  private static final long serialVersionUID ...
</I>&gt;<i>
</I>&gt;<i> [Message clipped]
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.berlios.de/pipermail/izpack-devel/attachments/20080124/ad4c0fef/attachment-0001.html">https://lists.berlios.de/pipermail/izpack-devel/attachments/20080124/ad4c0fef/attachment-0001.html</A> 
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001449.html">[izpack-devel] Production IzPack Mods
</A></li>
	<LI>Next message: <A HREF="001451.html">[izpack-devel] Trunk Merge Issue
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1455">[ date ]</a>
              <a href="thread.html#1455">[ thread ]</a>
              <a href="subject.html#1455">[ subject ]</a>
              <a href="author.html#1455">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/izpack-devel">More information about the izpack-devel
mailing list</a><br>
</body></html>
